{"ast":null,"code":"import _slicedToArray from\"/Users/maksim/Desktop/dev/mesto-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Form from\"../Form\";import Header from\"../Header\";import useInputHandling from\"../../custom_hooks/useInputHandling\";import{useState}from\"react\";import InfoToolTipPopup from\"../Popups/InfoToolTipPopup\";import{Link,Redirect}from\"react-router-dom\";import auth from\"../../utils/Auth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Register(){var _inputs$email$isValid,_inputs$email,_inputs$email2,_inputs$email3,_inputs$password$isVa,_inputs$password,_inputs$password2,_inputs$password3;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isPopupOpen=_useState4[0],setPopupState=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isRequestSucceeded=_useState6[0],setRequestState=_useState6[1];var hookConfig={defaultInputs:{email:{value:''},password:{value:''}},defaultInputIsValidState:false};var _useInputHandling=useInputHandling(hookConfig),_useInputHandling2=_slicedToArray(_useInputHandling,4),inputs=_useInputHandling2[0],isValid=_useInputHandling2[1],handleInputsUpdate=_useInputHandling2[2],handleChange=_useInputHandling2[3];function closePopup(){setPopupState(false);}function handleSubmit(evt){evt.preventDefault();setIsLoading(true);auth.register(inputs.email.value,inputs.password.value).then(function(){return setRequestState(true);}).catch(function(err){console.log(err);setRequestState(false);}).finally(function(){setIsLoading(false);setPopupState(true);});}return/*#__PURE__*/_jsxs(_Fragment,{children:[isRequestSucceeded&&!isPopupOpen&&/*#__PURE__*/_jsx(Redirect,{to:\"/sign-in\"}),/*#__PURE__*/_jsx(Header,{redirectLink:/*#__PURE__*/_jsx(Link,{className:\"header__link header__link_type_auth\",to:\"sign-in\",children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})}),/*#__PURE__*/_jsx(Form,{type:\"auth\",onSubmit:handleSubmit,isLoading:isLoading,isValid:isValid,inputs:inputs,name:\"register\",title:\"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\",submitText:\"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\",loadingSubmitText:\"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\",submitSubline:/*#__PURE__*/_jsxs(\"div\",{className:\"form__submit-subline\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"form__submit-subline-text\",children:\"\\u0423\\u0436\\u0435 \\u0437\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u044B?\"}),/*#__PURE__*/_jsx(Link,{className:\"form__submit-subline-link\",to:\"sign-in\",children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]}),inputFieldset:/*#__PURE__*/_jsxs(\"fieldset\",{className:\"form__input-container form__input-container_type_auth\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form__field\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form__input form__input_type_auth \".concat(!((_inputs$email$isValid=(_inputs$email=inputs.email)===null||_inputs$email===void 0?void 0:_inputs$email.isValid)!==null&&_inputs$email$isValid!==void 0?_inputs$email$isValid:true)?'form__input_invalid':''),name:\"email\",id:\"email-input\",type:\"email\",placeholder:\"Email\",required:true,onChange:handleChange,value:(_inputs$email2=inputs.email)===null||_inputs$email2===void 0?void 0:_inputs$email2.value}),/*#__PURE__*/_jsxs(\"span\",{className:\"form__input-error\",children:[\" \",(_inputs$email3=inputs.email)===null||_inputs$email3===void 0?void 0:_inputs$email3.errorMessage,\" \"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form__field\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form__input form__input_type_auth \".concat(!((_inputs$password$isVa=(_inputs$password=inputs.password)===null||_inputs$password===void 0?void 0:_inputs$password.isValid)!==null&&_inputs$password$isVa!==void 0?_inputs$password$isVa:true)?'form__input_invalid':''),name:\"password\",id:\"password-input\",type:\"password\",placeholder:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",required:true,minLength:\"2\",maxLength:\"30\",onChange:handleChange,value:(_inputs$password2=inputs.password)===null||_inputs$password2===void 0?void 0:_inputs$password2.value}),/*#__PURE__*/_jsxs(\"span\",{className:\"form__input-error\",children:[\" \",(_inputs$password3=inputs.password)===null||_inputs$password3===void 0?void 0:_inputs$password3.errorMessage,\" \"]})]})]})}),/*#__PURE__*/_jsx(InfoToolTipPopup,{isOpen:isPopupOpen,onClose:closePopup,isSucceeded:isRequestSucceeded})]});}","map":{"version":3,"names":["Form","Header","useInputHandling","useState","InfoToolTipPopup","Link","Redirect","auth","Register","isLoading","setIsLoading","isPopupOpen","setPopupState","isRequestSucceeded","setRequestState","hookConfig","defaultInputs","email","value","password","defaultInputIsValidState","inputs","isValid","handleInputsUpdate","handleChange","closePopup","handleSubmit","evt","preventDefault","register","then","catch","err","console","log","finally","errorMessage"],"sources":["/Users/maksim/Desktop/dev/mesto-react/src/components/AuthForms/Register.js"],"sourcesContent":["import Form from \"../Form\";\r\nimport Header from \"../Header\";\r\nimport useInputHandling from \"../../custom_hooks/useInputHandling\";\r\nimport { useState } from \"react\";\r\nimport InfoToolTipPopup from \"../Popups/InfoToolTipPopup\";\r\nimport { Link, Redirect } from \"react-router-dom\";\r\nimport auth from \"../../utils/Auth\";\r\n\r\nexport default function Register() {\r\n  const [ isLoading, setIsLoading ] = useState(false);\r\n  const [ isPopupOpen, setPopupState ] = useState(false);\r\n  const [ isRequestSucceeded, setRequestState ] = useState(false);\r\n  const hookConfig = {\r\n    defaultInputs: { email: { value: '' }, password: { value: '' } },\r\n    defaultInputIsValidState: false\r\n  }\r\n  const [ inputs, isValid, handleInputsUpdate, handleChange ] = useInputHandling(hookConfig);\r\n\r\n  function closePopup() {\r\n    setPopupState(false);\r\n  }\r\n\r\n  function handleSubmit(evt) {\r\n    evt.preventDefault();\r\n    \r\n    setIsLoading(true);\r\n    auth.register(inputs.email.value, inputs.password.value)\r\n      .then(() => setRequestState(true))\r\n      .catch((err) => {\r\n        console.log(err);\r\n        setRequestState(false);\r\n      })\r\n      .finally(() => {\r\n        setIsLoading(false);\r\n        setPopupState(true);\r\n      });\r\n  }\r\n\r\n  return(\r\n    <>\r\n      { (isRequestSucceeded && !isPopupOpen) && <Redirect to='/sign-in' />}\r\n      <Header \r\n        redirectLink={\r\n          <Link className=\"header__link header__link_type_auth\" to=\"sign-in\">Войти</Link>\r\n        }\r\n      />\r\n      <Form\r\n        type='auth'\r\n        onSubmit={handleSubmit}\r\n        isLoading={isLoading}\r\n        isValid={isValid}\r\n        inputs={inputs}\r\n        name=\"register\" \r\n        title=\"Регистрация\" \r\n        submitText=\"Зарегистрироваться\"\r\n        loadingSubmitText=\"Регистрация\"\r\n        submitSubline={\r\n          <div className='form__submit-subline'>\r\n            <p className=\"form__submit-subline-text\">Уже зарегистрированы?</p>\r\n            <Link className=\"form__submit-subline-link\" to='sign-in' >Войти</Link>\r\n          </div>\r\n        }\r\n        inputFieldset={\r\n          <fieldset className=\"form__input-container form__input-container_type_auth\">\r\n            <div className=\"form__field\">\r\n              <input\r\n                className={`form__input form__input_type_auth ${!(inputs.email?.isValid ?? true) ? 'form__input_invalid' : ''}`} \r\n                name=\"email\" \r\n                id=\"email-input\" \r\n                type=\"email\" \r\n                placeholder=\"Email\" \r\n                required \r\n                onChange={handleChange} \r\n                value={inputs.email?.value} \r\n              />\r\n              <span className=\"form__input-error\"> { inputs.email?.errorMessage } </span>\r\n            </div>\r\n            <div className=\"form__field\">\r\n              <input \r\n                className={`form__input form__input_type_auth ${!(inputs.password?.isValid ?? true) ? 'form__input_invalid' : ''}`} \r\n                name=\"password\" \r\n                id=\"password-input\" \r\n                type=\"password\" \r\n                placeholder=\"Пароль\" \r\n                required\r\n                minLength=\"2\" \r\n                maxLength=\"30\" \r\n                onChange={handleChange} \r\n                value={inputs.password?.value} \r\n              />\r\n              <span className=\"form__input-error\"> { inputs.password?.errorMessage } </span>\r\n            </div>\r\n          </fieldset>\r\n        } \r\n      />\r\n      <InfoToolTipPopup \r\n        isOpen={isPopupOpen}\r\n        onClose={closePopup}\r\n        isSucceeded={isRequestSucceeded}\r\n      />\r\n    </>\r\n  )\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}